---
title: "Datafest18"
author: "Sicong Li"
date: "March 23, 2018"
output: html_document
---

```{r}
library(tidyverse)
library(dplyr)
library(readr)
library(lubridate)
```

```{r}
Indeedsample <- read_csv('/Users/caroline/Downloads/Indeed_mini.csv')
Indeedsample <- Indeedsample %>%
  filter(country == "US") %>%
  select(country, admin1, city, employerIndustry, applies, employerJobCount, candStatusReviewedCount, jobagedays, date)

Visadata <- read_csv('/Users/caroline/Downloads/H-1B_Disclosure_Data_FY17.csv')
Visa_sample <- sample_n(Visadata, 100000)
```


```{r}
Indeedtest <- Indeedsample %>%
  mutate(month = floor_date(date, unit = "month")) %>%
  filter(country == "US") %>%
  select(country, admin1, city, employerIndustry, applies, employerJobCount, candStatusReviewedCount, jobagedays, month) %>%
  mutate(LaborSupplyDemRatio = applies/ employerJobCount) %>%
  group_by(month, employerIndustry) %>%
  summarise(mean = mean(LaborSupplyDemRatio))

Indeedplot <- ggplot(data=Indeedtest, aes(x=month, y=mean, color=employerIndustry, group = employerIndustry)) +
  geom_line()
Indeedplot
```


```{r}
IndeedTop5 <- Indeedsample %>%
  mutate(LaborSupplyDemRatio = applies/ employerJobCount) %>%
  group_by(employerIndustry) %>%
  summarise(sum = sum(LaborSupplyDemRatio)) %>%
  arrange(sum) %>%
  head(5)
```

